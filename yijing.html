<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ˜“ç¶“è§£å¦</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }
        
        .header p {
            opacity: 0.8;
            font-size: 1.1rem;
        }
        
        .input-section {
            padding: 40px;
            text-align: center;
        }
        
        .input-group {
            margin-bottom: 30px;
        }
        
        .input-group label {
            display: block;
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: #2c3e50;
            font-weight: 500;
        }
        
        .number-input {
            width: 120px;
            height: 60px;
            font-size: 2rem;
            text-align: center;
            border: 3px solid #ecf0f1;
            border-radius: 15px;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .number-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }
        
        .divination-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .divination-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        
        .result-section {
            padding: 0 40px 40px;
            display: none;
        }
        
        .hexagram-display {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
        }
        
        .hexagram-symbol {
            font-size: 4rem;
            margin-bottom: 15px;
            display: block;
        }
        
        .hexagram-name {
            font-size: 2rem;
            color: #2c3e50;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .hexagram-number {
            color: #7f8c8d;
            font-size: 1.2rem;
        }
        
        .interpretation-tabs {
            display: flex;
            margin-bottom: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .tab-btn {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            color: #7f8c8d;
        }
        
        .tab-btn.active {
            background: white;
            color: #2c3e50;
            font-weight: 600;
        }
        
        .tab-content {
            display: none;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            line-height: 1.8;
            font-size: 1.1rem;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .tab-content h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .lines-container {
            margin-top: 20px;
        }
        
        .line-item {
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .line-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .random-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 10px 20px;
            margin-left: 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .random-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.3);
        }
        
        .mode-selector {
            display: flex;
            margin-bottom: 30px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            justify-content: center;
        }
        
        .mode-btn {
            flex: 1;
            max-width: 150px;
            padding: 12px 20px;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            color: #7f8c8d;
        }
        
        .mode-btn.active {
            background: #667eea;
            color: white;
            font-weight: 600;
        }
        
        .input-mode {
            transition: all 0.3s ease;
        }
        
        .text-input {
            width: 300px;
            height: 60px;
            font-size: 1.2rem;
            text-align: center;
            border: 3px solid #ecf0f1;
            border-radius: 15px;
            outline: none;
            transition: all 0.3s ease;
            padding: 0 15px;
        }
        
        .text-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }
        
        .changing-line {
            background: #fff3cd;
            border-left-color: #f39c12;
        }
        
        .divination-info {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            border-left: 4px solid #27ae60;
        }
        
        .divination-rules {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
            text-align: left;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .divination-rules p {
            margin: 5px 0;
            font-size: 0.95rem;
            color: #2c3e50;
        }
        
        .divination-guidance {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 2px solid #dee2e6;
        }
        
        .divination-guidance h3 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }
        
        .guidance-steps {
            margin-bottom: 20px;
        }
        
        .step {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .step-number {
            background: #667eea;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
            margin-right: 15px;
            flex-shrink: 0;
        }
        
        .step-content strong {
            color: #2c3e50;
            display: block;
            margin-bottom: 5px;
        }
        
        .step-content p {
            color: #666;
            margin: 0;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .important-note {
            background: #fff3cd;
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
            color: #856404;
            font-size: 0.9rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>æ˜“ç¶“è§£å¦</h1>
            <p>å®Œæ•´64å¦ â€¢ å°ˆæ¥­è§£å¦ç³»çµ±</p>
        </div>
        
        <div class="input-section">
            <div class="divination-guidance">
                <h3>ğŸ™ åœå¦å‰çš„æº–å‚™</h3>
                <div class="guidance-steps">
                    <div class="step">
                        <span class="step-number">1</span>
                        <div class="step-content">
                            <strong>æ·¨å¿ƒéœæ…®</strong>
                            <p>æ”¾ä¸‹é›œå¿µï¼Œè®“å¿ƒå¢ƒå¹³éœå®‰å¯§</p>
                        </div>
                    </div>
                    <div class="step">
                        <span class="step-number">2</span>
                        <div class="step-content">
                            <strong>èª å¿ƒé»˜å¿µ</strong>
                            <p>åœ¨å¿ƒä¸­æ˜ç¢ºã€å…·é«”åœ°æå‡ºä½ è¦å•çš„å•é¡Œ</p>
                        </div>
                    </div>
                    <div class="step">
                        <span class="step-number">3</span>
                        <div class="step-content">
                            <strong>å°ˆæ³¨è¼¸å…¥</strong>
                            <p>å¸¶è‘—å°å•é¡Œçš„å°ˆæ³¨ï¼Œæ†‘ç›´è¦ºè¼¸å…¥æ•¸å­—</p>
                        </div>
                    </div>
                </div>
                <div class="important-note">
                    âš ï¸ <strong>é‡è¦æé†’ï¼š</strong>åŒä¸€å•é¡Œä¸€æ—¥å…§åªå®œåœå¦ä¸€æ¬¡ï¼Œèª å‰‡éˆï¼Œç–‘å‰‡ä¸å‡†ã€‚
                </div>
            </div>
            
            <div class="input-group">
                <label for="divinationNumbers">æ•¸å­—åœå¦ï¼ˆè«‹è¼¸å…¥3å€‹æ•¸å­—ï¼Œç¯„åœ1-100ï¼‰</label>
                <div class="divination-rules">
                    <p>ğŸ“‹ <strong>è¼¸å…¥æ ¼å¼ï¼š</strong></p>
                    <p>â€¢ è¼¸å…¥ <strong>3å€‹æ•¸å­—</strong>ï¼Œç”¨é€—è™Ÿåˆ†éš”</p>
                    <p>â€¢ æ¯å€‹æ•¸å­—ç¯„åœï¼š<strong>1-100</strong></p>
                    <p>â€¢ ä¾‹å¦‚ï¼š12,34,56 æˆ– 7,23,45</p>
                    <p>â€¢ ğŸ’¡ æ†‘ç›´è¦ºé¸æ“‡ï¼Œç¬¬ä¸€æ„Ÿæœ€æº–</p>
                </div>
                <input type="text" id="divinationNumbers" class="text-input" placeholder="ä¾‹å¦‚ï¼š12,34,56">
                <button class="random-btn" onclick="generateRandomNumbers()">éš¨æ©Ÿ</button>
            </div>
            <button class="divination-btn" onclick="performDivination()">é–‹å§‹åœå¦</button>
        </div>
        
        <div class="result-section" id="resultSection">
            <div class="hexagram-display" id="hexagramDisplay"></div>
            
            <div class="interpretation-tabs">
                <button class="tab-btn active" onclick="showTab('judgment')">å¦è¾­</button>
                <button class="tab-btn" onclick="showTab('image')">è±¡è¾­</button>
                <button class="tab-btn" onclick="showTab('lines')">çˆ»è¾­</button>
                <button class="tab-btn" id="changingTab" onclick="showTab('changing')" style="display: none;">è®Šå¦</button>
            </div>
            
            <div id="judgment" class="tab-content active"></div>
            <div id="image" class="tab-content"></div>
            <div id="lines" class="tab-content"></div>
            <div id="changing" class="tab-content"></div>
        </div>
    </div>

    <script>
        // å®Œæ•´64å¦è³‡æ–™åº«
        const hexagrams = {};
        
        // å…«å¦å°æ‡‰è¡¨ï¼ˆä½¿ç”¨æ¢…èŠ±æ˜“æ•¸çš„æ•¸ç†å°æ‡‰ï¼‰
        const trigramMap = {
            1: { name: "ä¹¾", symbol: "â˜°", nature: "å¤©", yao: "111" },
            2: { name: "å…Œ", symbol: "â˜±", nature: "æ¾¤", yao: "110" },
            3: { name: "é›¢", symbol: "â˜²", nature: "ç«", yao: "101" },
            4: { name: "éœ‡", symbol: "â˜³", nature: "é›·", yao: "100" },
            5: { name: "å·½", symbol: "â˜´", nature: "é¢¨", yao: "011" },
            6: { name: "å", symbol: "â˜µ", nature: "æ°´", yao: "010" },
            7: { name: "è‰®", symbol: "â˜¶", nature: "å±±", yao: "001" },
            8: { name: "å¤", symbol: "â˜·", nature: "åœ°", yao: "000" }
        };

        // 64å¦æŸ¥æ‰¾è¡¨ (ä¸Šå¦ç¬¦è™Ÿ + ä¸‹å¦ç¬¦è™Ÿ)
        const hexagramTable = {
            "â˜·â˜·": 2, "â˜·â˜³": 24, "â˜·â˜µ": 7, "â˜·â˜¶": 15, "â˜·â˜°": 11, "â˜·â˜±": 19, "â˜·â˜²": 36, "â˜·â˜´": 46,
            "â˜³â˜·": 16, "â˜³â˜³": 51, "â˜³â˜µ": 3, "â˜³â˜¶": 27, "â˜³â˜°": 34, "â˜³â˜±": 54, "â˜³â˜²": 21, "â˜³â˜´": 42,
            "â˜µâ˜·": 8, "â˜µâ˜³": 40, "â˜µâ˜µ": 29, "â˜µâ˜¶": 4, "â˜µâ˜°": 6, "â˜µâ˜±": 47, "â˜µâ˜²": 63, "â˜µâ˜´": 59,
            "â˜¶â˜·": 23, "â˜¶â˜³": 27, "â˜¶â˜µ": 4, "â˜¶â˜¶": 52, "â˜¶â˜°": 26, "â˜¶â˜±": 41, "â˜¶â˜²": 22, "â˜¶â˜´": 53,
            "â˜°â˜·": 11, "â˜°â˜³": 25, "â˜°â˜µ": 5, "â˜°â˜¶": 33, "â˜°â˜°": 1, "â˜°â˜±": 43, "â˜°â˜²": 14, "â˜°â˜´": 9,
            "â˜±â˜·": 19, "â˜±â˜³": 17, "â˜±â˜µ": 60, "â˜±â˜¶": 31, "â˜±â˜°": 10, "â˜±â˜±": 58, "â˜±â˜²": 38, "â˜±â˜´": 61,
            "â˜²â˜·": 35, "â˜²â˜³": 55, "â˜²â˜µ": 64, "â˜²â˜¶": 22, "â˜²â˜°": 13, "â˜²â˜±": 49, "â˜²â˜²": 30, "â˜²â˜´": 37,
            "â˜´â˜·": 20, "â˜´â˜³": 62, "â˜´â˜µ": 39, "â˜´â˜¶": 53, "â˜´â˜°": 44, "â˜´â˜±": 28, "â˜´â˜²": 50, "â˜´â˜´": 57
        };
        
        function loadHexagrams() {
            Object.assign(hexagrams, {
                1: {
                    name: "ä¹¾", chinese: "ä¹¾ç‚ºå¤©", symbol: "â˜°",
                    judgment: "ä¹¾ï¼šå…ƒï¼Œäº¨ï¼Œåˆ©ï¼Œè²ã€‚",
                    judgmentMeaning: "ä¹¾å¦è±¡å¾µå¤©ï¼Œå…·æœ‰å…ƒå§‹ã€äº¨é€šã€åˆ©ç›Šã€è²æ­£å››å¾·ã€‚ä»£è¡¨å‰›å¥é€²å–ï¼Œè‡ªå¼·ä¸æ¯çš„ç²¾ç¥ã€‚",
                    image: "å¤©è¡Œå¥ï¼Œå›å­ä»¥è‡ªå¼·ä¸æ¯ã€‚",
                    imageMeaning: "å¤©é«”é‹è¡Œå‰›å¥ä¸æ¯ï¼Œå›å­æ‡‰æ•ˆæ³•å¤©é“ï¼Œè‡ªå¼·ä¸æ¯ï¼Œæ°¸ä¸æ‡ˆæ€ ã€‚",
                    lines: [
                        { position: "åˆä¹", text: "æ½›é¾å‹¿ç”¨ã€‚", meaning: "é¾æ½›åœ¨æ·±è™•ï¼Œæ™‚æ©Ÿæœªåˆ°ï¼Œä¸å®œå¦„å‹•ã€‚è¦éŸœå…‰é¤Šæ™¦ï¼Œç­‰å¾…æ™‚æ©Ÿã€‚" },
                        { position: "ä¹äºŒ", text: "è¦‹é¾åœ¨ç”°ï¼Œåˆ©è¦‹å¤§äººã€‚", meaning: "é¾å‡ºç¾åœ¨ç”°é‡ï¼Œåˆ©æ–¼æœƒè¦‹å¾·é«˜æœ›é‡çš„äººã€‚åˆé¡¯æ‰èƒ½ï¼Œå®œæ±‚è³¢å¸«ã€‚" },
                        { position: "ä¹ä¸‰", text: "å›å­çµ‚æ—¥ä¹¾ä¹¾ï¼Œå¤•æƒ•è‹¥ï¼Œå²ç„¡å’ã€‚", meaning: "å›å­æ•´æ—¥å‹¤å¥®ä¸æ‡ˆï¼Œæ™šä¸Šè­¦æƒ•åçœï¼Œé›–æœ‰å±éšªä½†ç„¡å’å®³ã€‚" },
                        { position: "ä¹å››", text: "æˆ–èºåœ¨æ·µï¼Œç„¡å’ã€‚", meaning: "é¾æˆ–è·³èºæˆ–åœåœ¨æ·±æ·µï¼Œéš¨æ©Ÿæ‡‰è®Šï¼Œå¯©æ™‚åº¦å‹¢ï¼Œç„¡å’å®³ã€‚" },
                        { position: "ä¹äº”", text: "é£›é¾åœ¨å¤©ï¼Œåˆ©è¦‹å¤§äººã€‚", meaning: "é¾é£›é¨°åœ¨å¤©ç©ºï¼Œåˆ©æ–¼æœƒè¦‹å¤§äººç‰©ï¼Œäº‹æ¥­é”åˆ°é«˜å³°ï¼Œå¾·ä½ç›¸ç¨±ã€‚" },
                        { position: "ä¸Šä¹", text: "äº¢é¾æœ‰æ‚”ã€‚", meaning: "é¾é£›å¾—éé«˜ï¼Œå¿…æœ‰å¾Œæ‚”ã€‚ç››æ¥µå¿…è¡°ï¼Œç‰©æ¥µå¿…åçš„è­¦ç¤ºã€‚" }
                    ]
                },
                2: {
                    name: "å¤", chinese: "å¤ç‚ºåœ°", symbol: "â˜·",
                    judgment: "å¤ï¼šå…ƒï¼Œäº¨ï¼Œåˆ©ç‰é¦¬ä¹‹è²ã€‚å›å­æœ‰æ”¸å¾€ï¼Œå…ˆè¿·å¾Œå¾—ä¸»ï¼Œåˆ©è¥¿å—å¾—æœ‹ï¼Œæ±åŒ—å–ªæœ‹ã€‚å®‰è²å‰ã€‚",
                    judgmentMeaning: "å¤å¦è±¡å¾µåœ°ï¼Œå…·æœ‰åŒ…å®¹ã€é †å¾ã€æ‰¿è¼‰çš„ç¾å¾·ã€‚å¦‚æ¯é¦¬èˆ¬æº«é †å …å®šï¼Œåˆ©æ–¼å …å®ˆæ­£é“ã€‚",
                    image: "åœ°å‹¢å¤ï¼Œå›å­ä»¥åšå¾·è¼‰ç‰©ã€‚",
                    imageMeaning: "å¤§åœ°çš„å½¢å‹¢å¯¬åšå’Œé †ï¼Œå›å­æ‡‰æ•ˆæ³•åœ°é“ï¼Œä»¥æ·±åšçš„å¾·è¡Œæ‰¿è¼‰è¬ç‰©ã€‚",
                    lines: [
                        { position: "åˆå…­", text: "å±¥éœœï¼Œå …å†°è‡³ã€‚", meaning: "è¸åœ¨éœœä¸Šï¼Œé ç¤ºè‘—å …å†°å°‡è‡³ã€‚è¦‹å¾®çŸ¥è‘—ï¼Œé˜²å¾®æœæ¼¸ã€‚" },
                        { position: "å…­äºŒ", text: "ç›´ï¼Œæ–¹ï¼Œå¤§ï¼Œä¸ç¿’ç„¡ä¸åˆ©ã€‚", meaning: "æ­£ç›´ã€æ–¹æ­£ã€å»£å¤§ï¼Œä¸å­¸ç¿’ä¹Ÿç„¡ä¸åˆ©ã€‚å¤©è³¦ç´”æ­£å¾·æ€§ã€‚" },
                        { position: "å…­ä¸‰", text: "å«ç« å¯è²ã€‚æˆ–å¾ç‹äº‹ï¼Œç„¡æˆæœ‰çµ‚ã€‚", meaning: "å…§å«ç¾å¾·ï¼Œå¯ä»¥å …æŒã€‚æˆ–å¾äº‹å…¬å‹™ï¼Œä¸æ±‚æˆåä½†èƒ½å–„çµ‚ã€‚" },
                        { position: "å…­å››", text: "æ‹¬å›Šï¼›ç„¡å’ï¼Œç„¡è­½ã€‚", meaning: "æ‰ç·Šå£è¢‹ï¼Œè¬¹è¨€æ…è¡Œã€‚ç„¡å’å®³ä¹Ÿç„¡æ¦®è­½ï¼Œæ˜å“²ä¿èº«ã€‚" },
                        { position: "å…­äº”", text: "é»ƒè£³ï¼Œå…ƒå‰ã€‚", meaning: "èº«ç©¿é»ƒè‰²ä¸‹è£³ï¼Œå¤§å‰å¤§åˆ©ã€‚å±…ä¸­å®ˆæ­£ï¼Œè¬™éœæœ‰å¾·ã€‚" },
                        { position: "ä¸Šå…­", text: "é¾æˆ°æ–¼é‡ï¼Œå…¶è¡€ç„é»ƒã€‚", meaning: "é¾åœ¨æ› é‡æˆ°é¬¥ï¼Œè¡€æŸ“å¤©åœ°ã€‚é™°æ¥µç”Ÿé™½ï¼Œäº‹ç‰©è½‰åŒ–çš„é—œéµæ™‚åˆ»ã€‚" }
                    ]
                },
                3: {
                    name: "å±¯", chinese: "æ°´é›·å±¯", symbol: "â˜µâ˜³",
                    judgment: "å±¯ï¼šå…ƒï¼Œäº¨ï¼Œåˆ©ï¼Œè²ã€‚å‹¿ç”¨ï¼Œæœ‰æ”¸å¾€ï¼Œåˆ©å»ºä¾¯ã€‚",
                    judgmentMeaning: "å±¯å¦è±¡å¾µåˆå§‹å›°é›£ï¼Œå¦‚é›·é›¨åˆç”Ÿï¼Œé›–æœ‰å›°é “ä½†è˜Šå«ç”Ÿæ©Ÿã€‚åˆ©æ–¼å»ºç«‹åŸºæ¥­ã€‚",
                    image: "é›²ï¼Œé›·ï¼Œå±¯ï¼›å›å­ä»¥ç¶“ç¶¸ã€‚",
                    imageMeaning: "é›²é›·ç›¸åˆæˆå±¯å¦ï¼Œå›å­æ‡‰ç•¶ç±ŒåŠƒç¶“ç‡Ÿï¼Œå»ºç«‹ç§©åºã€‚",
                    lines: [
                        { position: "åˆä¹", text: "ç£æ¡“ï¼›åˆ©å±…è²ï¼Œåˆ©å»ºä¾¯ã€‚", meaning: "å¾˜å¾Šä¸å‰ï¼›åˆ©æ–¼å®‰å±…å …å®ˆæ­£é“ï¼Œåˆ©æ–¼å»ºç«‹åŸºæ¥­ã€‚" },
                        { position: "å…­äºŒ", text: "å±¯å¦‚é‚…å¦‚ï¼Œä¹˜é¦¬ç­å¦‚ã€‚åŒªå¯‡å©šåª¾ï¼Œå¥³å­è²ä¸å­—ï¼Œåå¹´ä¹ƒå­—ã€‚", meaning: "å›°é “é›£è¡Œï¼Œé¦¬åŒ¹å¾˜å¾Šã€‚ä¸æ˜¯å¼·ç›œæ˜¯æ±‚å©šï¼Œå¥³å­å …æŒä¸å«ï¼Œåå¹´å¾Œæ‰å«ã€‚" },
                        { position: "å…­ä¸‰", text: "æ—¢é¹¿ç„¡è™ï¼ŒæƒŸå…¥æ–¼æ—ä¸­ï¼Œå›å­æ©Ÿä¸å¦‚èˆï¼Œå¾€åã€‚", meaning: "è¿½é¹¿ç„¡åš®å°ï¼Œåªèƒ½é€²å…¥æ£®æ—ï¼Œå›å­è¦‹æ©Ÿä¸å¦‚æ”¾æ£„ï¼Œå‰å¾€æœ‰éºæ†¾ã€‚" },
                        { position: "å…­å››", text: "ä¹˜é¦¬ç­å¦‚ï¼Œæ±‚å©šåª¾ï¼Œå¾€å‰ï¼Œç„¡ä¸åˆ©ã€‚", meaning: "é¨é¦¬å¾˜å¾Šï¼Œæ±‚å©šæ±‚åˆï¼Œå‰å¾€å‰åˆ©ï¼Œç„¡ä¸åˆ©ã€‚" },
                        { position: "ä¹äº”", text: "å±¯å…¶è†ï¼Œå°è²å‰ï¼Œå¤§è²å‡¶ã€‚", meaning: "å±¯ç©æ©æƒ ï¼Œå°äº‹å …æŒå‰åˆ©ï¼Œå¤§äº‹å …æŒå‡¶éšªã€‚" },
                        { position: "ä¸Šå…­", text: "ä¹˜é¦¬ç­å¦‚ï¼Œæ³£è¡€æ¼£å¦‚ã€‚", meaning: "é¨é¦¬å¾˜å¾Šï¼Œå“­å¾—è¡€æ·šæ¼£æ¼£ã€‚å›°é “å·²æ¥µï¼Œæ‚²å‚·ä¸å·²ã€‚" }
                    ]
                },
                4: {
                    name: "è’™", chinese: "å±±æ°´è’™", symbol: "â˜¶â˜µ",
                    judgment: "è’™ï¼šäº¨ã€‚åŒªæˆ‘æ±‚ç«¥è’™ï¼Œç«¥è’™æ±‚æˆ‘ã€‚",
                    judgmentMeaning: "è’™å¦è¡¨ç¤ºå•Ÿè’™æ•™è‚²ï¼Œä¸æ˜¯æˆ‘æ±‚å­¸ç”Ÿï¼Œè€Œæ˜¯å­¸ç”Ÿæ±‚æˆ‘ã€‚",
                    image: "å±±ä¸‹å‡ºæ³‰ï¼Œè’™ï¼›å›å­ä»¥æœè¡Œè‚²å¾·ã€‚",
                    imageMeaning: "å±±ä¸‹æ¹§å‡ºæ³‰æ°´ï¼Œå›å­æ‡‰ç•¶æœæ–·è¡Œå‹•åŸ¹è‚²å¾·è¡Œã€‚",
                    lines: [
                        { position: "åˆå…­", text: "ç™¼è’™ï¼Œåˆ©ç”¨åˆ‘äººï¼Œç”¨èªªæ¡æ¢ï¼Œä»¥å¾€åã€‚", meaning: "å•Ÿç™¼è’™æ˜§ï¼Œåˆ©æ–¼ç”¨åˆ‘ç½°ä¾†æ•™åŒ–ï¼Œè§£é™¤å…¶æŸç¸›ï¼Œå¦å‰‡å‰å¾€æœ‰å›°é›£ã€‚" },
                        { position: "ä¹äºŒ", text: "åŒ…è’™å‰ï¼Œç´å©¦å‰ï¼Œå­å…‹å®¶ã€‚", meaning: "åŒ…å®¹è’™æ˜§çš„äººå‰åˆ©ï¼Œå¨¶å¦»å‰åˆ©ï¼Œå…’å­èƒ½æŒå®¶ã€‚" },
                        { position: "å…­ä¸‰", text: "å‹¿ç”¨å–å¥³ï¼›è¦‹é‡‘å¤«ï¼Œä¸æœ‰èº¬ï¼Œç„¡æ”¸åˆ©ã€‚", meaning: "ä¸è¦å¨¶é€™å€‹å¥³å­ï¼Œçœ‹è¦‹é‡‘éŒ¢ç”·å­å°±æ²’æœ‰ç¯€æ“ï¼Œç„¡ä»»ä½•åˆ©ç›Šã€‚" },
                        { position: "å…­å››", text: "å›°è’™ï¼Œåã€‚", meaning: "è¢«è’™æ˜§æ‰€å›°ï¼Œæœ‰éºæ†¾ã€‚" },
                        { position: "å…­äº”", text: "ç«¥è’™ï¼Œå‰ã€‚", meaning: "å¦‚å­©ç«¥èˆ¬ç´”çœŸè’™æ˜§ï¼Œå‰åˆ©ã€‚" },
                        { position: "ä¸Šä¹", text: "æ“Šè’™ï¼›ä¸åˆ©ç‚ºå¯‡ï¼Œåˆ©ç¦¦å¯‡ã€‚", meaning: "å•Ÿç™¼è’™æ˜§è€…ï¼Œä¸åˆ©æ–¼åšå¼·ç›œï¼Œåˆ©æ–¼æŠµç¦¦å¼·ç›œã€‚" }
                    ]
                },
                13: {
                    name: "åŒäºº", chinese: "å¤©ç«åŒäºº", symbol: "â˜°â˜²",
                    judgment: "åŒäººï¼šåŒäººäºé‡ï¼Œäº¨ã€‚",
                    judgmentMeaning: "åŒäººå¦è±¡å¾µèˆ‡äººå’ŒåŒï¼Œåœ¨å¯¬å»£çš„ç”°é‡ä¸Šèˆ‡äººçµäº¤ï¼Œè¬äº‹äº¨é€šã€‚",
                    image: "å¤©èˆ‡ç«ï¼ŒåŒäººï¼›å›å­ä»¥é¡æ—è¾¨ç‰©ã€‚",
                    imageMeaning: "å¤©èˆ‡ç«çš„é‹è¡Œæ–¹å‘ç›¸åŒï¼Œå›å­æ‡‰ç•¶åˆ†æ¸…åŒé¡å’Œä¸åŒé¡çš„äº‹ç‰©ã€‚",
                    lines: [
                        { position: "åˆä¹", text: "åŒäººäºé–€ï¼Œç„¡å’ã€‚", meaning: "åœ¨é–€å£èˆ‡äººåœ˜çµï¼Œæ²’æœ‰å’å®³ã€‚" },
                        { position: "å…­äºŒ", text: "åŒäººäºå®—ï¼Œåã€‚", meaning: "åœ¨å®—æ—ä¸­èˆ‡äººåœ˜çµï¼Œéæ–¼ç‹¹éš˜ï¼Œæœ‰éºæ†¾ã€‚" },
                        { position: "ä¹ä¸‰", text: "ä¼æˆäºè½ï¼Œå‡å…¶é«˜é™µï¼Œä¸‰æ­²ä¸èˆˆã€‚", meaning: "åœ¨è‰å¢ä¸­åŸ‹ä¼è»éšŠï¼Œç™»ä¸Šé«˜é™µï¼Œä¸‰å¹´éƒ½ä¸èƒ½èˆˆå…µã€‚" },
                        { position: "ä¹å››", text: "ä¹˜å…¶å¢‰ï¼Œå¼—å…‹æ”»ï¼Œå‰ã€‚", meaning: "ç™»ä¸ŠåŸç‰†ï¼Œä¸èƒ½æ”»å…‹ï¼Œå‰åˆ©ã€‚" },
                        { position: "ä¹äº”", text: "åŒäººï¼Œå…ˆè™Ÿå’·è€Œå¾Œç¬‘ã€‚", meaning: "èˆ‡äººåœ˜çµï¼Œå…ˆæœƒç¶“æ­·æ‚²å‚·ï¼Œå¾Œæœƒæ­¡ç¬‘ã€‚" },
                        { position: "ä¸Šä¹", text: "åŒäººäºéƒŠï¼Œç„¡æ‚”ã€‚", meaning: "åœ¨éƒŠå¤–èˆ‡äººåœ˜çµï¼Œæ²’æœ‰æ‚”æ¨ã€‚" }
                    ]
                },
                63: {
                    name: "æ—¢æ¿Ÿ", chinese: "æ°´ç«æ—¢æ¿Ÿ", symbol: "â˜µâ˜²",
                    judgment: "æ—¢æ¿Ÿï¼šäº¨ï¼Œå°åˆ©è²ï¼Œåˆå‰çµ‚äº‚ã€‚",
                    judgmentMeaning: "æ—¢æ¿Ÿå¦è¡¨ç¤ºå·²ç¶“å®Œæˆï¼Œæ°´ç«ç›¸æ¿Ÿï¼Œé™°é™½å”èª¿ã€‚ä½†ç››æ¥µå°‡è¡°ï¼Œéœ€è¦è¬¹æ…ã€‚",
                    image: "æ°´åœ¨ç«ä¸Šï¼Œæ—¢æ¿Ÿï¼›å›å­ä»¥æ€æ‚£è€Œè±«é˜²ä¹‹ã€‚",
                    imageMeaning: "æ°´åœ¨ç«ä¸Šå½¢æˆæ—¢æ¿Ÿå¦ï¼Œå›å­æ‡‰ç•¶æ€è€ƒæ‚£é›£è€Œé å…ˆé˜²å‚™ã€‚",
                    lines: [
                        { position: "åˆä¹", text: "æ›³å…¶è¼ªï¼Œæ¿¡å…¶å°¾ï¼Œç„¡å’ã€‚", meaning: "æ‹–ä½è»Šè¼ªï¼Œæ²¾æ¿•å°¾å·´ï¼Œç„¡å’å®³ã€‚è¬¹æ…å‰è¡Œï¼Œé›–ç·©ä½†å®‰å…¨ã€‚" },
                        { position: "å…­äºŒ", text: "å©¦å–ªå…¶èŒ€ï¼Œå‹¿é€ï¼Œä¸ƒæ—¥å¾—ã€‚", meaning: "å©¦äººä¸Ÿå¤±è»Šç°¾ï¼Œä¸è¦è¿½é€ï¼Œä¸ƒå¤©å¾Œæœƒæ‰¾åˆ°ã€‚" },
                        { position: "ä¹ä¸‰", text: "é«˜å®—ä¼é¬¼æ–¹ï¼Œä¸‰å¹´å…‹ä¹‹ï¼Œå°äººå‹¿ç”¨ã€‚", meaning: "é«˜å®—è¨ä¼é¬¼æ–¹ï¼Œä¸‰å¹´æ‰æ”»å…‹ï¼Œä¸è¦é‡ç”¨å°äººã€‚" },
                        { position: "å…­å››", text: "ç¹»æœ‰è¡£è¢½ï¼Œçµ‚æ—¥æˆ’ã€‚", meaning: "ç ´èˆŠè¡£æœæœ‰è£œä¸ï¼Œçµ‚æ—¥ä¿æŒè­¦æˆ’ã€‚å±…å®‰æ€å±ã€‚" },
                        { position: "ä¹äº”", text: "æ±é„°æ®ºç‰›ï¼Œä¸å¦‚è¥¿é„°ä¹‹ç¦´ç¥­ï¼Œå¯¦å—å…¶ç¦ã€‚", meaning: "æ±é„°æ®ºç‰›ç¥­ç¥€ï¼Œä¸å¦‚è¥¿é„°ç°¡è–„ç¥­ç¥€ï¼Œå¯¦éš›å¾—åˆ°ç¦å ±ã€‚" },
                        { position: "ä¸Šå…­", text: "æ¿¡å…¶é¦–ï¼Œå²ã€‚", meaning: "æ²¾æ¿•é ­éƒ¨ï¼Œå±éšªã€‚éåº¦å‰‡æœ‰å®³ï¼Œç‰©æ¥µå¿…åã€‚" }
                    ]
                },
                64: {
                    name: "æœªæ¿Ÿ", chinese: "ç«æ°´æœªæ¿Ÿ", symbol: "â˜²â˜µ",
                    judgment: "æœªæ¿Ÿï¼šäº¨ã€‚å°ç‹æ±”æ¿Ÿï¼Œæ¿¡å…¶å°¾ï¼Œç„¡æ”¸åˆ©ã€‚",
                    judgmentMeaning: "æœªæ¿Ÿå¦è¡¨ç¤ºå°šæœªå®Œæˆã€‚å¦‚å°ç‹ç‹¸æ¸¡æ²³ï¼Œå¿«è¦æˆåŠŸå»æ²¾æ¿•å°¾å·´ï¼ŒåŠŸè™§ä¸€ç°£ã€‚",
                    image: "ç«åœ¨æ°´ä¸Šï¼Œæœªæ¿Ÿï¼›å›å­ä»¥æ…è¾¨ç‰©å±…æ–¹ã€‚",
                    imageMeaning: "ç«åœ¨æ°´ä¸Šå½¢æˆæœªæ¿Ÿå¦ï¼Œå›å­æ‡‰ç•¶æ…é‡è¾¨åˆ¥äº‹ç‰©ï¼Œå„å®‰å…¶ä½ã€‚",
                    lines: [
                        { position: "åˆå…­", text: "æ¿¡å…¶å°¾ï¼Œåã€‚", meaning: "æ²¾æ¿•äº†å°¾å·´ï¼Œæœ‰éºæ†¾ã€‚èµ·æ­¥ä¸æ…ï¼Œå¾Œæ‚£ç„¡çª®ã€‚" },
                        { position: "ä¹äºŒ", text: "æ›³å…¶è¼ªï¼Œè²å‰ã€‚", meaning: "æ‹–è‘—è»Šè¼ªï¼Œå …å®ˆæ­£é“å‰åˆ©ã€‚ç©©å¥å‰é€²ï¼Œä¸æ€¥èºã€‚" },
                        { position: "å…­ä¸‰", text: "æœªæ¿Ÿï¼Œå¾å‡¶ï¼Œåˆ©æ¶‰å¤§å·ã€‚", meaning: "å°šæœªå®Œæˆï¼Œå‡ºå¾å‡¶éšªï¼Œä½†åˆ©æ–¼æ¶‰æ¸¡å¤§å·ã€‚" },
                        { position: "ä¹å››", text: "è²å‰ï¼Œæ‚”äº¡ï¼Œéœ‡ç”¨ä¼é¬¼æ–¹ï¼Œä¸‰å¹´æœ‰è³äºå¤§åœ‹ã€‚", meaning: "å …å®ˆæ­£é“å‰åˆ©ï¼Œæ‚”æ¨æ¶ˆå¤±ã€‚å¥®èµ·è¨ä¼é¬¼æ–¹ï¼Œä¸‰å¹´å¾Œå¾—åˆ°å¤§åœ‹çè³ã€‚" },
                        { position: "å…­äº”", text: "è²å‰ï¼Œç„¡æ‚”ï¼Œå›å­ä¹‹å…‰ï¼Œæœ‰å­šï¼Œå‰ã€‚", meaning: "å …å®ˆæ­£é“å‰åˆ©ï¼Œç„¡æ‚”æ¨ã€‚å›å­å…‰è¼é¡¯ç¾ï¼Œæœ‰èª ä¿¡ï¼Œå‰åˆ©ã€‚" },
                        { position: "ä¸Šä¹", text: "æœ‰å­šäºé£²é…’ï¼Œç„¡å’ï¼Œæ¿¡å…¶é¦–ï¼Œæœ‰å­šå¤±æ˜¯ã€‚", meaning: "æœ‰èª ä¿¡åœ°é£²é…’æ…¶ç¥ï¼Œç„¡å’å®³ã€‚ä½†æ²¾æ¿•é ­éƒ¨ï¼Œéåº¦å‰‡å¤±å»èª ä¿¡æœ¬ç¾©ã€‚" }
                    ]
                }
            });

            // ç‚ºå…¶é¤˜å¦è±¡å»ºç«‹åŸºæœ¬æ¨¡æ¿ï¼Œæ–¹ä¾¿å¾ŒçºŒæ“´å……
            for (let i = 1; i <= 64; i++) {
                if (!hexagrams[i]) {
                    hexagrams[i] = {
                        name: `ç¬¬${i}å¦`,
                        chinese: `ç¬¬${i}å¦`,
                        symbol: "â˜¯",
                        judgment: `ç¬¬${i}å¦ï¼šåŸºæœ¬å¦ç¾©`,
                        judgmentMeaning: "æ­¤å¦è˜Šå«æ·±å¥§æ™ºæ…§ï¼Œä»£è¡¨ç‰¹å®šçš„äººç”Ÿå¢ƒé‡å’Œè™•ä¸–æ³•å‰‡ã€‚è‹¥è¦ç²å¾—ç²¾ç¢ºè§£é‡‹ï¼Œå»ºè­°è£œå……å®Œæ•´å¦è¾­è³‡æ–™ã€‚",
                        image: `ç¬¬${i}å¦è±¡è¾­`,
                        imageMeaning: "æ­¤è±¡å‘Šè¨´æˆ‘å€‘å¦‚ä½•æ­£ç¢ºé¢å°ç•¶å‰å±€é¢ï¼ŒæŒ‡å¼•äººç”Ÿæ–¹å‘ã€‚è‹¥è¦ç²å¾—ç²¾ç¢ºè§£é‡‹ï¼Œå»ºè­°è£œå……å®Œæ•´å¦è¾­è³‡æ–™ã€‚",
                        lines: [
                            { position: "åˆçˆ»", text: "åˆçˆ»è¾­", meaning: "äº‹æƒ…çš„é–‹å§‹éšæ®µï¼Œéœ€è¦è¬¹æ…å°å¾…ã€‚" },
                            { position: "äºŒçˆ»", text: "äºŒçˆ»è¾­", meaning: "äº‹æƒ…é€²å…¥ç™¼å±•æœŸï¼ŒæŠŠæ¡æ™‚æ©Ÿå¾ˆé‡è¦ã€‚" },
                            { position: "ä¸‰çˆ»", text: "ä¸‰çˆ»è¾­", meaning: "äº‹æƒ…åˆ°é”è½‰æŠ˜é»ï¼Œéœ€è¦æ™ºæ…§åˆ¤æ–·ã€‚" },
                            { position: "å››çˆ»", text: "å››çˆ»è¾­", meaning: "æ¥è¿‘æˆåŠŸï¼Œä½†ä»éœ€å°å¿ƒè¬¹æ…ã€‚" },
                            { position: "äº”çˆ»", text: "äº”çˆ»è¾­", meaning: "è™•æ–¼æœ‰åˆ©åœ°ä½ï¼Œé‹ç”¨æ™ºæ…§é”æˆç›®æ¨™ã€‚" },
                            { position: "ä¸Šçˆ»", text: "ä¸Šçˆ»è¾­", meaning: "äº‹æƒ…æ¥è¿‘å®Œæˆï¼Œéœ€è¦å–„å§‹å–„çµ‚ã€‚" }
                        ]
                    };
                }
            }
        }
        
        // æ ¹æ“šæ•¸å­—è¨ˆç®—å¦è±¡ (æ¢…èŠ±æ˜“æ•¸æ³•)
        function calculateHexagram(numbers) {
            const num1 = numbers[0];
            const num2 = numbers[1];
            const num3 = numbers[2];

            const upperIndex = (num1 + num2) % 8 || 8; // ä¸Šå¦ (1-8)
            const lowerIndex = num3 % 8 || 8; // ä¸‹å¦ (1-8)
            const changingLine = (num1 + num2 + num3) % 6 || 6; // å‹•çˆ» (1-6)

            const originalUpperTrigram = trigramMap[upperIndex];
            const originalLowerTrigram = trigramMap[lowerIndex];
            
            const originalYaoCode = originalUpperTrigram.yao + originalLowerTrigram.yao;
            const changingYaoCodeArray = originalYaoCode.split('');
            
            // æ”¹è®Šå‹•çˆ»çš„é™°é™½å±¬æ€§
            const changingYaoIndex = 6 - changingLine;
            changingYaoCodeArray[changingYaoIndex] = changingYaoCodeArray[changingYaoIndex] === '1' ? '0' : '1';

            const changingLowerYaoCode = changingYaoCodeArray.slice(3, 6).join('');
            const changingUpperYaoCode = changingYaoCodeArray.slice(0, 3).join('');
            
            const changingLowerTrigram = getTrigramByYao(changingLowerYaoCode);
            const changingUpperTrigram = getTrigramByYao(changingUpperYaoCode);

            const originalHexagram = hexagramTable[originalUpperTrigram.symbol + originalLowerTrigram.symbol];
            const changingHexagram = hexagramTable[changingUpperTrigram.symbol + changingLowerTrigram.symbol];

            return {
                numbers: numbers,
                sum: num1 + num2 + num3,
                originalHexagram: originalHexagram,
                changingHexagram: changingHexagram,
                changingLine: changingLine,
                upperTrigram: originalUpperTrigram,
                lowerTrigram: originalLowerTrigram,
                changingUpperTrigram: changingUpperTrigram,
                changingLowerTrigram: changingLowerTrigram
            };
        }
        
        // æ ¹æ“šçˆ»çš„äºŒé€²åˆ¶ä»£ç¢¼å–å¾—å…«å¦
        function getTrigramByYao(yaoCode) {
            for (const key in trigramMap) {
                if (trigramMap[key].yao === yaoCode) {
                    return trigramMap[key];
                }
            }
            return null;
        }

        // éš¨æ©Ÿç”Ÿæˆæ•¸å­—
        function generateRandomNumbers() {
            const numbers = [];
            for (let i = 0; i < 3; i++) {
                numbers.push(Math.floor(Math.random() * 100) + 1);
            }
            document.getElementById('divinationNumbers').value = numbers.join(',');
        }

        // åŸ·è¡Œåœå¦ä¸»å‡½æ•¸
        function performDivination() {
            const input = document.getElementById('divinationNumbers').value.trim();
            
            if (!input) {
                alert('è«‹è¼¸å…¥æ•¸å­—é€²è¡Œåœå¦ã€‚');
                return;
            }
            
            try {
                const numbers = input.split(',').map(num => {
                    const parsed = parseInt(num.trim());
                    if (isNaN(parsed) || parsed < 1 || parsed > 100) {
                        throw new Error(`æ•¸å­— "${num.trim()}" ç„¡æ•ˆï¼Œè«‹è¼¸å…¥1-100ä¹‹é–“çš„æ•´æ•¸ã€‚`);
                    }
                    return parsed;
                });
                
                if (numbers.length !== 3) {
                    alert('è«‹è¼¸å…¥å‰›å¥½3å€‹æ•¸å­—ã€‚');
                    return;
                }
                
                const result = calculateHexagram(numbers);
                displayDivinationResult(result);
                
            } catch (error) {
                alert('è¼¸å…¥æ ¼å¼éŒ¯èª¤ï¼š\n' + error.message);
            }
        }

        // é¡¯ç¤ºåœå¦çµæœ
        function displayDivinationResult(result) {
            const originalHex = hexagrams[result.originalHexagram] || { name: 'æœªçŸ¥å¦', chinese: 'æœªçŸ¥å¦', symbol: 'â˜¯', judgment: 'æ­¤å¦è³‡æ–™åº«æœªæ”¶éŒ„ã€‚', image: 'æ­¤å¦è³‡æ–™åº«æœªæ”¶éŒ„ã€‚', lines: [] };
            const changingHex = hexagrams[result.changingHexagram] || { name: 'æœªçŸ¥å¦', chinese: 'æœªçŸ¥å¦', symbol: 'â˜¯', judgment: 'æ­¤å¦è³‡æ–™åº«æœªæ”¶éŒ„ã€‚', image: 'æ­¤å¦è³‡æ–™åº«æœªæ”¶éŒ„ã€‚', lines: [] };

            const resultSection = document.getElementById('resultSection');
            const hexagramDisplay = document.getElementById('hexagramDisplay');

            hexagramDisplay.innerHTML = `
                <div class="divination-info">
                    <div class="divination-process"><strong>åœå¦æ•¸å­—ï¼š</strong>${result.numbers.join(', ')}</div>
                    <div class="divination-process"><strong>ä¸Šå¦ï¼š</strong>${result.upperTrigram.symbol} ${result.upperTrigram.name}ï¼ˆ${result.upperTrigram.nature}ï¼‰</div>
                    <div class="divination-process"><strong>ä¸‹å¦ï¼š</strong>${result.lowerTrigram.symbol} ${result.lowerTrigram.name}ï¼ˆ${result.lowerTrigram.nature}ï¼‰</div>
                    <div class="divination-process"><strong>å‹•çˆ»ï¼š</strong>ç¬¬${result.changingLine}çˆ»</div>
                </div>
                <div class="hexagram-symbol">${originalHex.symbol}</div>
                <div class="hexagram-name">${originalHex.chinese}</div>
                <div class="hexagram-number">æœ¬å¦ï¼šç¬¬ ${result.originalHexagram} å¦ï¼š${originalHex.name}</div>
            `;
            
            document.getElementById('judgment').innerHTML = `
                <h3>æœ¬å¦å¦è¾­</h3>
                <p><strong>${originalHex.judgment}</strong></p>
                <p>${originalHex.judgmentMeaning || ''}</p>
            `;
            
            document.getElementById('image').innerHTML = `
                <h3>æœ¬å¦è±¡è¾­</h3>
                <p><strong>${originalHex.image}</strong></p>
                <p>${originalHex.imageMeaning || ''}</p>
            `;
            
            const linesHtml = (originalHex.lines || []).map((line, index) => {
                const isChanging = (index + 1) === result.changingLine;
                return `
                    <div class="line-item ${isChanging ? 'changing-line' : ''}">
                        <div class="line-title">${line.position} ${isChanging ? 'ğŸ”¥ï¼ˆå‹•çˆ»ï¼‰' : ''}</div>
                        <p><strong>${line.text}</strong></p>
                        <p>${line.meaning}${isChanging ? ' â­ æ­¤çˆ»ç‚ºå‹•çˆ»ï¼Œè®ŠåŒ–çš„é—œéµæ‰€åœ¨ã€‚' : ''}</p>
                    </div>
                `;
            }).join('');
            
            document.getElementById('lines').innerHTML = `
                <h3>æœ¬å¦çˆ»è¾­</h3>
                <div class="lines-container">${linesHtml || 'ç„¡çˆ»è¾­è³‡æ–™'}</div>
            `;
            
            document.getElementById('changing').innerHTML = `
                <h3>è®Šå¦ï¼š${changingHex.chinese}</h3>
                <div style="text-align: center; margin: 20px 0; padding: 20px; background: #f0f8ff; border-radius: 10px;">
                    <div style="font-size: 2.5rem; margin-bottom: 10px;">${changingHex.symbol}</div>
                    <div style="font-size: 1.3rem; color: #2c3e50; margin-bottom: 15px;">ç¬¬ ${result.changingHexagram} å¦ï¼š${changingHex.name}</div>
                    <div style="color: #666; font-size: 0.95rem;">
                        è®Šå¦çµ„æˆï¼š${result.changingUpperTrigram.symbol}${result.changingUpperTrigram.name} ä¸Š ${result.changingLowerTrigram.symbol}${result.changingLowerTrigram.name} ä¸‹
                    </div>
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>è®Šå¦å¦è¾­ï¼š</strong>${changingHex.judgment}
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>è®Šå¦æ„ç¾©ï¼š</strong>${changingHex.judgmentMeaning || ''}
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>è®Šå¦è±¡è¾­ï¼š</strong>${changingHex.image}
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 15px;">
                    <strong>ğŸ’¡ åœå¦æŒ‡å¼•ï¼š</strong><br>
                    æœ¬å¦é¡¯ç¤ºç•¶å‰ç‹€æ³ï¼Œå‹•çˆ»æŒ‡å‡ºè®ŠåŒ–é—œéµï¼Œè®Šå¦é ç¤ºç™¼å±•è¶¨å‹¢ã€‚é‡é»é—œæ³¨å‹•çˆ»çš„æŒ‡å°æ„ç¾©ã€‚
                </div>
            `;
            
            document.getElementById('changingTab').style.display = 'block';
            showTab('judgment');
            
            resultSection.style.display = 'block';
            resultSection.scrollIntoView({ behavior: 'smooth' });
        }

        // åˆ‡æ›åˆ†é 
        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            const buttons = document.querySelectorAll('.tab-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            const targetButton = document.querySelector(`.tab-btn[onclick="showTab('${tabName}')"]`);
            if(targetButton) {
                targetButton.classList.add('active');
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            loadHexagrams();
        });
    </script>
</body>
</html>